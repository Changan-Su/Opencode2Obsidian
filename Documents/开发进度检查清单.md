# 开发进度检查清单

## v0.1.0 核心功能开发

### 项目初始化 ⏳
- [ ] 创建基础目录结构 (src/, tests/, assets/)
- [ ] 复制并调整配置文件
  - [ ] package.json
  - [ ] tsconfig.json
  - [ ] esbuild.config.mjs
  - [ ] manifest.json
  - [ ] .gitignore
- [ ] 安装依赖 (`bun install`)
- [ ] 验证构建系统 (`bun run build`)

### 01-插件初始化 ⏳
- [ ] 实现 `src/types.ts`
  - [ ] OpenCodeSettings接口
  - [ ] DEFAULT_SETTINGS常量
  - [ ] OPENCODE_VIEW_TYPE常量
- [ ] 实现 `src/icons.ts`
  - [ ] registerOpenCodeIcons函数
  - [ ] SVG图标定义
- [ ] 实现 `src/main.ts`
  - [ ] OpenCodePlugin类骨架
  - [ ] onload() 生命周期
  - [ ] onunload() 清理
  - [ ] loadSettings() / saveSettings()
  - [ ] 命令注册
    - [ ] toggle-opencode-view
    - [ ] start-opencode-server
    - [ ] stop-opencode-server
  - [ ] Ribbon图标
  - [ ] 视图管理方法
  - [ ] 项目目录获取
- [ ] 测试
  - [ ] 插件加载成功
  - [ ] 设置加载保存
  - [ ] 命令可用
- [ ] 更新文档: `Documents/Function/01-插件初始化/功能文档.md`

### 02-OpenCode服务管理 ⏳
- [ ] 实现 `src/ProcessManager.ts`
  - [ ] ProcessManager类结构
  - [ ] ProcessState类型定义
  - [ ] 构造函数和成员变量
  - [ ] start() 方法
    - [ ] 状态检查
    - [ ] 健康检查(复用已有服务)
    - [ ] spawn进程
    - [ ] 参数配置(port, hostname, cors)
    - [ ] 等待服务就绪
    - [ ] 超时处理
  - [ ] stop() 方法
    - [ ] SIGTERM优雅关闭
    - [ ] 超时强制SIGKILL
  - [ ] checkServerHealth()
    - [ ] fetch /global/health
    - [ ] 超时处理
  - [ ] waitForServerOrExit()
    - [ ] 轮询健康检查
    - [ ] 检测进程提前退出
  - [ ] getUrl() - base64编码路径
  - [ ] 状态管理
    - [ ] setState()
    - [ ] setError()
    - [ ] 状态回调通知
  - [ ] 进程事件处理
    - [ ] stdout/stderr日志
    - [ ] exit事件
    - [ ] error事件
- [ ] 测试
  - [ ] 启动成功
  - [ ] 健康检查通过
  - [ ] 停止成功
  - [ ] 错误处理(可执行文件不存在等)
  - [ ] 状态变更通知
- [ ] 更新文档: `Documents/Function/02-OpenCode服务管理/功能文档.md`

### 03-Obsidian视图集成 ⏳
- [ ] 实现 `src/OpenCodeView.ts`
  - [ ] OpenCodeView类继承ItemView
  - [ ] 基础方法
    - [ ] getViewType()
    - [ ] getDisplayText()
    - [ ] getIcon()
  - [ ] onOpen() 生命周期
    - [ ] 清空容器
    - [ ] 订阅状态变更
    - [ ] 初始渲染
    - [ ] 懒启动逻辑
  - [ ] onClose() 生命周期
    - [ ] 取消订阅
    - [ ] 清理iframe
  - [ ] updateView() 路由
  - [ ] 状态渲染方法
    - [ ] renderStoppedState() - 启动按钮
    - [ ] renderStartingState() - 加载动画
    - [ ] renderRunningState() - iframe和控制按钮
    - [ ] renderErrorState() - 错误信息和重试
  - [ ] reloadIframe() - iframe重载
- [ ] 实现 `src/SettingsTab.ts`
  - [ ] OpenCodeSettingTab类继承PluginSettingTab
  - [ ] display() 方法
  - [ ] 设置项
    - [ ] OpenCode路径
    - [ ] 端口
    - [ ] 主机名
    - [ ] 自动启动
    - [ ] 启动超时
    - [ ] 项目目录
    - [ ] 默认视图位置
- [ ] 实现 `styles.css`
  - [ ] .opencode-container
  - [ ] .opencode-iframe-container
  - [ ] .opencode-iframe
  - [ ] .opencode-status-container
  - [ ] .opencode-header
  - [ ] 加载动画
  - [ ] 错误状态样式
- [ ] 测试
  - [ ] 视图打开/关闭
  - [ ] 各状态UI正确显示
  - [ ] iframe加载
  - [ ] 控制按钮功能
  - [ ] 设置保存和应用
- [ ] 更新文档: `Documents/Function/03-Obsidian视图集成/功能文档.md`

### 集成测试 ⏳
- [ ] 完整流程测试
  - [ ] 首次安装
  - [ ] 启动OpenCode
  - [ ] 视图交互
  - [ ] 服务重启
  - [ ] 错误恢复
- [ ] 边界场景
  - [ ] OpenCode未安装
  - [ ] 端口被占用
  - [ ] 服务启动失败
  - [ ] 进程异常退出
- [ ] 性能测试
  - [ ] 启动时间
  - [ ] 内存占用
  - [ ] CPU使用

### 文档和发布准备 ⏳
- [ ] 更新所有功能文档的"复盘"部分
- [ ] 更新 `Documents/Track/版本更新.md`
- [ ] 更新 `Documents/项目开发计划.md`
- [ ] 编写 CHANGELOG.md
- [ ] 准备README和使用说明
- [ ] 截图和演示
- [ ] 标记v0.1.0版本

## v0.2.0 增强功能开发

### 04-跨平台支持 ⏳
- [ ] Windows路径处理优化
- [ ] 可执行文件查找逻辑
- [ ] 进程终止优化(taskkill)
- [ ] 测试
  - [ ] Windows 10/11
  - [ ] macOS
  - [ ] Linux
- [ ] 更新文档

### 05-Skills集成 ⏳
- [ ] 设计skills存储结构
- [ ] 创建示例skills (3-4个)
  - [ ] note-summarizer
  - [ ] markdown-formatter
  - [ ] knowledge-linker
  - [ ] daily-note-helper (可选)
- [ ] Skills管理UI
- [ ] 配置OpenCode环境变量
- [ ] 测试skills功能
- [ ] 更新文档

## v0.3.0 高级功能开发

### 06-AGENTS初始化 ⏳
- [ ] AGENTS.md模板设计
- [ ] Vault结构分析
- [ ] 检测和初始化流程
- [ ] 初始化对话框
- [ ] 内容生成逻辑
- [ ] 测试
- [ ] 更新文档

## v1.0.0 正式版准备

- [ ] 完整测试套件
- [ ] 文档完善
- [ ] 用户指南
- [ ] 社区发布
  - [ ] 提交到Obsidian社区插件
  - [ ] GitHub Release
  - [ ] 发布公告

## 文档维护检查

### 开发过程中
- [ ] 遇到问题记录在对应功能文档
- [ ] 解决方案更新到"问题与解决"
- [ ] 实现细节更新到"实现要点"

### 功能完成后
- [ ] 填写"复盘"部分
- [ ] 更新"后续"待办
- [ ] 在功能索引中标记状态

### 版本发布前
- [ ] 更新Track/版本更新.md
- [ ] 检查Structure/结构记录.md
- [ ] 更新项目开发计划.md
- [ ] 同步README.md

---

**使用说明**:
- ⏳ 待开始
- 🚧 进行中  
- ✅ 已完成
- ❌ 已取消

**更新频率**: 每完成一个模块更新一次

**最后更新**: 2026-01-18
